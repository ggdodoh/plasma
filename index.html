<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>플라즈마 임피던스 시뮬레이터</title>
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
</head>
<body class="bg-gray-50 text-gray-800 font-sans p-6">
  <div class="max-w-5xl mx-auto">
    <!-- 헤더 -->
    <header class="mb-6">
      <h1 class="text-3xl font-bold text-blue-800 mb-2">🔬 플라즈마 임피던스 시뮬레이터 (밀도 기반 자동 계산)</h1>
      <p class="text-sm text-gray-600">이 시뮬레이터는 플라즈마의 전자 밀도, 이온 밀도, sheath 두께 등의 물리량을 기반으로 자동으로 R, L, C 값을 계산하고 임피던스 특성을 시각화합니다.</p>
    </header>

    <!-- 입력 슬라이더 -->
    <section class="bg-white p-4 rounded shadow mb-6">
      <h2 class="text-xl font-semibold mb-4">⚙️ 물리 파라미터 입력</h2>
      <div class="space-y-4 text-sm">
        <div>
          <label class="block font-medium">전자 밀도 (nₑ, /m³): <span id="neVal" class="font-bold text-blue-700"></span></label>
          <input type="range" id="ne" min="1e15" max="1e19" step="1e16" value="1e17" class="w-full">
        </div>
        <div>
          <label class="block font-medium">sheath 두께 (d, m): <span id="dVal" class="font-bold text-blue-700"></span></label>
          <input type="range" id="d" min="1e-4" max="5e-3" step="1e-4" value="1e-3" class="w-full">
        </div>
        <div>
          <label class="block font-medium">전극 면적 (A, m²): <span id="aVal" class="font-bold text-blue-700"></span></label>
          <input type="range" id="a" min="0.001" max="0.1" step="0.001" value="0.01" class="w-full">
        </div>
        <div>
          <button onclick="convertAndSimulate()" class="mt-4 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">시뮬레이션</button>
        </div>
      </div>
    </section>

    <!-- 회로 파라미터 자동 계산 결과 -->
    <section class="bg-white p-4 rounded shadow mb-6">
      <h2 class="text-xl font-semibold mb-2">🔧 회로 요소 자동 계산 (R, L, C)</h2>
      <div class="text-sm text-gray-700" id="rlc-values"></div>
    </section>

    <!-- 그래프 -->
    <section class="bg-white p-4 rounded shadow mb-6">
      <h2 class="text-xl font-semibold mb-2">📊 임피던스 그래프</h2>
      <div id="plot" class="w-full h-96"></div>
      <div class="mt-4 text-sm text-gray-700" id="resonance-info"></div>
    </section>

    <!-- 결과 해석 -->
    <section class="bg-white p-4 rounded shadow mb-6">
      <h2 class="text-xl font-semibold mb-2">🧠 결과 해석</h2>
      <div id="analysis" class="text-sm text-gray-800 space-y-2">
        <p>시뮬레이션 결과를 바탕으로 공진 주파수 및 임피던스의 특성을 분석합니다.</p>
      </div>
    </section>

    <!-- 시뮬레이터 해석 팁 -->
    <section class="bg-white p-4 rounded shadow mb-6">
      <h2 class="text-xl font-semibold mb-2">💡 시뮬레이터 해석 팁</h2>
      <ul class="list-disc pl-5 text-sm">
        <li>그래프가 sharp하게 떨어지는 경우 → 공진이 뚜렷 → L, C 차이가 큼</li>
        <li>그래프가 평탄한 경우 → 저항 성분이 지배적 → R이 크거나 공진 없음</li>
        <li>공진점이 왼쪽(저주파) → C 작거나 L 큼 (저밀도 플라즈마)</li>
        <li>공진점이 오른쪽(고주파) → C 큼 또는 L 작음 (고밀도 플라즈마)</li>
      </ul>
    </section>

    <!-- 예시 시나리오 -->
    <section class="bg-white p-4 rounded shadow mb-6">
      <h2 class="text-xl font-semibold mb-2">🧪 예시: 인자별 플라즈마 반응</h2>
      <ul class="list-disc pl-5 text-sm space-y-2">
        <li><b>전자 밀도가 매우 높다:</b> L 감소 → 공진점이 고주파 쪽으로 이동</li>
        <li><b>Sheath 두께가 커짐:</b> C 감소 → 공진점이 저주파 쪽으로 이동</li>
        <li><b>충돌률이 증가:</b> R 증가 → 공진이 흐려짐, 전체 임피던스 상승</li>
      </ul>
    </section>

    <!-- 풋터 -->
    <footer class="text-center text-sm text-gray-500 mt-10">
      Powered by GPT &middot; HTML 기반 플라즈마 학습용 도구
    </footer>
  </div>

  <script>
    const e = 1.6e-19;
    const me = 9.1e-31;
    const eps0 = 8.85e-12;

    function convertAndSimulate() {
      const ne = parseFloat(document.getElementById("ne").value);
      const d = parseFloat(document.getElementById("d").value);
      const A = parseFloat(document.getElementById("a").value);

      const L = me / (ne * e * e * A);         // H
      const C = eps0 * A / d;                  // F
      const R = 1 / (ne * e * e * 1e-3);       // 단순 저항 근사 (임의 모델)

      document.getElementById("rlc-values").innerHTML = `
        <p><b>전자 밀도:</b> ${ne.toExponential()} /m³</p>
        <p><b>Sheath 두께:</b> ${d} m</p>
        <p><b>전극 면적:</b> ${A} m²</p>
        <p><b>계산된 L:</b> ${L.toExponential(3)} H</p>
        <p><b>계산된 C:</b> ${C.toExponential(3)} F</p>
        <p><b>계산된 R:</b> ${R.toExponential(3)} Ω</p>
      `;

      simulateImpedance(R, L, C, ne);
    }

    function simulateImpedance(R, L, C, ne) {
      let freq = [], Zmag = [], Zre = [], Zim = [];
      let resonanceFreq = null;
      let minImZ = Infinity, minFreq = null;

      for (let f = 1e5; f <= 1e7; f += 1e5) {
        const omega = 2 * Math.PI * f;
        const XL = omega * L;
        const XC = 1 / (omega * C);
        const ReZ = R;
        const ImZ = XL - XC;
        const MagZ = Math.sqrt(ReZ ** 2 + ImZ ** 2);

        freq.push(f / 1e6);
        Zmag.push(MagZ);
        Zre.push(ReZ);
        Zim.push(ImZ);

        if (Math.abs(ImZ) < Math.abs(minImZ)) {
          minImZ = ImZ;
          minFreq = f / 1e6;
        }

        if (Math.abs(ImZ) < 5 && !resonanceFreq) {
          resonanceFreq = f / 1e6;
        }
      }

      Plotly.newPlot('plot', [
        { x: freq, y: Zmag, mode: 'lines', name: '|Z|' },
        { x: freq, y: Zre, mode: 'lines', name: 'Re(Z)' },
        { x: freq, y: Zim, mode: 'lines', name: 'Im(Z)' }
      ], {
        title: '주파수(MHz) vs 임피던스',
        xaxis: { title: '주파수 (MHz)' },
        yaxis: { title: '임피던스 (Ω)' }
      });

      const resDiv = document.getElementById("resonance-info");
      const anaDiv = document.getElementById("analysis");

      if (resonanceFreq) {
        resDiv.innerHTML = `📍 공진 주파수: <b>${resonanceFreq.toFixed(2)} MHz</b> (Im(Z) ≈ 0)`;
        let densityComment = ne > 1e18 ? "고밀도 플라즈마 조건입니다." : (ne < 1e16 ? "저밀도 플라즈마입니다." : "중간 밀도입니다.");
        anaDiv.innerHTML = `
          <p>${densityComment}</p>
          <p>공진점은 ${resonanceFreq.toFixed(2)} MHz 부근이며, 이때 Im(Z)가 0에 근접하고 임피던스는 실수값 R로 수렴합니다.</p>
          <p>최대 에너지 전달이 가능하며 실험 설계에서 매우 중요한 기준점입니다.</p>
        `;
      } else {
        resDiv.innerHTML = `⚠️ 공진점(Im(Z)=0)을 찾을 수 없습니다.`;
        anaDiv.innerHTML = `<p>공진 조건이 형성되지 않았습니다. 밀도, 면적, sheath 조건을 변경해 보세요.</p>`;
      }
    }

    document.getElementById("ne").addEventListener("input", () => {
      document.getElementById("neVal").innerText = parseFloat(document.getElementById("ne").value).toExponential();
    });
    document.getElementById("d").addEventListener("input", () => {
      document.getElementById("dVal").innerText = document.getElementById("d").value + " m";
    });
    document.getElementById("a").addEventListener("input", () => {
      document.getElementById("aVal").innerText = document.getElementById("a").value + " m²";
    });

    window.onload = () => {
      document.getElementById("ne").dispatchEvent(new Event("input"));
      document.getElementById("d").dispatchEvent(new Event("input"));
      document.getElementById("a").dispatchEvent(new Event("input"));
      convertAndSimulate();
    };
  </script>
</body>
</html>


